**Azure cloud shell**

Offered in bash and powershell

**Use Azure powershell**

To create a new VM using powershell

New-AzVm

- ResourceGroupName “CRMTestingResourceGroup”
- Name “CRMTestUnits”
- Image “UbuntuLTS”

………….

Azure powershell is also available in two ways: inside a browser via the Azure Cloud Shell, or with a local installation on macOS or Windows

Interactive mode - issuing one command at a time

Scripting mode - execute a script that consists of multiple commands

**Use Azure CLI**

Restarting a VM

Az vm restart -g MyResourceGroup -n MyVm

**Azure Resource Manager**

**Manage Azure Identities and Governance**

Manager subscription and governance

- Configure resource locks
- Manager resource groups
- 

**Deploy and manage Azure compute resources**

Configuring VM

- Moving resources from one group to another

**Review Azure Resource Manager benefits**

- You can deploy, manage and monitor all the resources as a group
- Can manager resources through templates
- RBAC - access control
- Tags to organize the resources in subscription
- Clarifying the org resources using the tags that are associated with the resources

**Terminology**

**Resource** - manageable item available through azure

**Resource Group** - container holds the azure resources for azure solution.

**Resource provider** - service that supplies the resources that can be deployed and managed through resource manager

**Template** - JSON file that defines one or more resource to deploy in a resource group

**Declarative syntax -** sequence of programming command what you intend to create

**Create a resource group**

Resources can be created in any existing or a new group

**Considerations**

Resource group can only exist in one resource group

Groups cannot be renamed

Can have resources of many different types

Can have resources from many different regions

**Creating a resource group**

All resources should share same lifecycle

Each resources can exist only in one resource group

Can move resources from one group to another

Resources group can contain resources from different region

Can be used to scope access control for administrative actions

Can interact with other resources in other resource group

**Create Azure Resource Manager locks**

Resource manager allows to put lock on the resources that prevents accidental deletion of resources in Azure

You can associate a lock with subscription, resource group, or resource.

Lock are inherited by child resource

**2 types**

**Read-only locks**, which prevents any changes to the resources

**Delete locks**, which prevents deletion.

**Reorganizing Azure resources**

Moving resources between two groups / subscriptions / regions

**Remove resources and resource groups**

Deleting a resource group will delete all the resources within that group

Powershell command to delete a resource group - Remove-AzResourceGroup -Name "ContosoRG01"

**Removing resources**

Here you can delete the individual resources within a resource group

You also can move the resource from one group to another

**Determining azure limits**

Azure lets you view usage against limits. This is helpful to track current usage, and plan for future use.

**Configure resources with Azure resource manager templates**

**Azure manager template - advantage**

Precisely defines all the Resource manager in a deployment

Can be deployed in a single operation

**Benefits**

- Improves consistency
- Helps express complex deployments
- Reduces manual, error prone task
- Templates are Codes
- Promote reuse
- Linkable
- Simplify orchestration

**Template schema**

Written in JSON.

Collection key-value pairs

Each key is a string whose value can be

- String
- Number
- Boolean Express
- List of values
- Object

Resource manager template can be using a sections that are expressed using JSON notation, but are not relatable to the JSON language itself:

{

"$schema": "http://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",

"contentVersion": "",

"parameters": {},

"variables": {},

"functions": [],

"resources": [],

"outputs": {}

}

$schema - Location of JSON file

contentVersion - version of the template

Parameters - Values that are provided during deployment

Variables - Values that are used as JSON fragments to simplify the resource deployment

Functions - user defined functions that are available within template

Resources - resources that are deployed or updated in resource group

Outputs - values that are returned after deployments

**Automate Azure tasks using scripts with Powershell**

3 Administration tools

- Azure portal
- Azure CLI
- Azure Powershell

**Install Powershell**

Powershell 7.1.3 or higher is required

You would have to add azure Powershell module to installation

**$PSVersionTable.PSVersion** - to check the version of the powershell installed

**pwsh -ver** - shot form of checking the version of the powershell

**dotnet tool install --global PowerShell** - command to install the newest version of the powershell

**Create an Azure Resource using scripts in Azure Powershell**

Powershell lets you write command and execute them immediately - Interactive mode

When a command is entered into powerShell, PowerShell matches the command to a cmdlet and PowerShell performs the action requested.

**Powershell cmdlets**

Small command.

**Powershell module**

Cmdlets are shipped in modules

DLL that includes the code to process each available cmdlet.

You can get the list of loaded modules using **Get-Module** command

**Az Powershell Module**

**Az** is the formal name for the Azure Powershell module.

**Installing Az powershell module**

**Install-Module -Name Az -Scope CurrentUser -Repository PSGallery** - used to install the powershell module for Azure

**Update-Module -Name Az**  - to update a powershell module

**Creating a Resource Group with Azure PowerShell**

To create a azure resource group there are 4 steps need to be performed before

- Import the azure cmdlets
- Connect to your azure subscription
- Create the resource group
- Verify that creation was successful

**Importing the azure cmdlets**

Cmdlets are preinstalled now a days

**Connect to Azure using powershell**

***Connect-AzAccount*** can be used to connect to the azure account via powershell

If you have multiple azure subscription you might need to use **Set-AzContext -Subscription ‘0000000000000000000000000000000’**

0000.. Indicates the subscription ID

You can retrieve a list of azure resources using **Get-AzResourceGroup**

To get more concise view of you can send output from Get-AZResourceGroup to the Format-Table cmdlet using a pipe |. **Get-AzResourceGroup | Format-Table**

**Creating a resource group**

New-AzResourceGroup -Name AzureLearning -Location EastUS

**To filter a specific resource on a resource group**

Get-AzResource -ResourceGroupName ExerciseResources

Get-AzResource -ResourceGroupName AzureLearning

**Creating a VM using azure powershell**

**New-AzVM** helps in creating a new VM

New-AzVm

-ResourceGroupName <resource group name>

-Name <machine name>

-Credential <credentials object>

-Location <location>

-Image <image name>

**Remove-AzVM** deletes a VM

**Start-AzVm** starts a VM

**Stop-AzVM** Stops a VM

**Restart-AzVM** restarts a VM

**Update-AzVM** Updates the configuration for a VM

**To list the VMs** in your subscription **Get-AzVM -status**

You could also try checking the status of a particular VM using the -name parameter

$vm = Get-AzVM  -Name ***MyVM*** -ResourceGroupName ***AzureLearning***

You could also **updated the VM using the Update-AzVM** command

$ResourceGroupName = "***AzureLearning***"

$vm = Get-AzVM  -Name ***TestVM1*** -ResourceGroupName $***AzureLearning***

$vm.HardwareProfile.vmSize = "***Standard_DS3_v2***"

Update-AzVM -ResourceGroupName $***ResourceGroupName***  -VM $***vm***

New-AzVm -ResourceGroupName **learn-f09a7a33-b74b-4ec6-aedd-e8e3294698ac** -Name "**testvm-eus-01**" -Credential (Get-Credential) -Location "**East US**" -Image **UbuntuLTS** -OpenPorts **22** -PublicIpAddressName "**testvm-01**"

- ***Create and save scripts in Azure PowerShell**

COME BACK TO IT LATER

**Control Azure services with CLI**

***az vm restart -g MyResourceGroup -n MyVm*** to restart a VM

**Installing and running Azure CLI from local computer**

https://aka.ms/installazurecliwindows

Installing CLI module  on windows from here is how to do it

Once installed you can go into powershell and run CLI commands to make it work

- ***Exercise - Create an Azure website using the CLI**

Come back to it later

**Deploy Azure infrastructure by using JSON ARM template**

Can be written using Visual studio code to develop a ARM template

COME BACK TO IT LATER

**Configure Azure Active directory**

**Describe Azure Active Directory benefits and features**

Azure AD is a microsoft’s multi-tenant cloud-based directory and identity management services.

**Describe Azure Active Directory concepts**

**Identity** - An object that can get authenticated. An identity can be a user with username and password. Identities also include applications or other servers that might require authentication through secret keys or certificates.

**Account** - An identity that has data associated with it. You can’t have an account with an identity.

**Azure AD Account -** Identity created through azure AD or another Microsoft cloud service, such as Microsoft 365. Identities are stored in Azure AD and accessible to your organization cloud subscription

**Azure Subscription -** Used to pay for azure cloud services. You can have many subscriptions and they’re linked to a credit card.

**Azure tenant/directory -** A dedicated and trusted instance of azure AD, a tenant is automatically setup when your organization sings up for a microsoft cloud service subscription

- More instance of azure AD can be created
- Azure AD is the underlying product providing the identity services
- The term tenant mean a single instance of azure AD representing a single organization
- The term tenant and directory are often used interchangeably.

**Compare active directory domain services to azure active directory**

AD DS is the traditional deployment of windows server-based active directory on a physical or virtual server.

**Select Az active directory editions**

4 editions

- Free
- Microsoft 365
- Premium P1
- Premium P2

**Implement Azure active directory join**

Single sign on

Enterprise state roaming

Access to Microsoft store

Windows Hello

Restriction of access

Seamless access

**Connection option**

Registering

Joining

**Implementing self service password reset**

Self service Password Reset (SSPR)

**Configure user and group accounts**

**Create user account**

Cloud identities

Directory-Synchronized identities

Guest users

**Manage User accounts**

Things to consider

- User profile is optional
- Deleted users can be restored for 30 days.
- Sign in and audit log information is available

**Create Bulk user accounts**

Supports creating and deleting bulk users by filling out the comma separated values

**Create Group Accounts**

Security groups

Microsoft 365 groups

**Adding members to group**

There are different ways you can add/assign access rights

- Assigned - unique permissions for a specific user
- Dynamic user - uses dynamic member rules to automatically add/remove members
- Dynamic device - uses dynamic group rules to automatically add/remove members

**Create administrative units**

Can be useful to restrict administrative scope by using administrative units in organizations that are made up of independent divisions of any kind

**Configure Subscriptions**

Getting a subscription / implementing cost management / applying resource tags

**Identify regions**

**Things to know about regional pairs**

Physical isolation

Platform provided replication

Region recovery order

Sequential updates

Data residency

**Implement Azure subscription**

**Azure accounts**

Subscriptions have accounts. Account is simply an identity in an azure ad.

**Getting access to resources**

Every azure subscription can be associated with and azure active directory

Users and services will then authenticate with azure active directory before accessing resources

**Obtain a subscription**

Enterprise / Resellers / Partners / Personal

**Identify subscription usage**

Most commonly used subscription are

Free

Pay as you go

Enterprise Agreement

Student

**Implement cost management**

**Plan and control expenses**

Cost analysis

Budgets

Recommendations

Exporting cost management data

**Apply resource tagging**

You can apply azure resource to logically organize them by categorizes

Each tag consists of a name and a value.

Considerations

Each resource/resource group can have a maximum of 50 tag name/value pair

Tags that are applied to the resources in that resource group

**Apply cost savings**

Reservations

Azure hybrid Benefits

Azure credits

Budgets

Pricing calculator

**Configure Azure Policy**

**Create management groups**

If your organization has several subscription, you may need a way to efficiently manage access policy and compliance for those subscription

**Implement Azure Policy**

Service in azure you used to create, assign and manage policies.

Advantages - Compliance, scaling and remediation

**Creating Azure policy**

- Browse policy definitions
- Create initiative definitions
- Scope the initiative definitions
- View policy evaluation results

**Create policy definitions**

**Create initiative definitions**

**Scope the initiative definitions**

**Determine Compliance**

**Configure RBAC**

Says who can access cloud resources and what they could do with that

**What can I do**

Allow application to access all resources in RG

Allow one user to manage virtual machines in subscription and other user manage virtual networks

Allow DBA group to manage SQL Databases in a subscription

Allow a user to manage all resources in a resource group, such as virtual machines, websites and subnets.

**Concepts**

Security principal

Role definition

Scope

Assignment

**Create a role definition**

Name, ID, Description

Allowable permissions

Denied permissions

Scope

**Actions and NotActions**

Owner - *

Contributor - * (Other than writing or deleting)

Reader - */read

**Scope your roles**

After actions/not actions you would have to scope your roles

**Create a role assignment**

This is to grant access.

Access is revoked by removing a role assignment

**Compare Azure roles to Azure active directory roles**

- Classic subscription administrator roles
- Azure role-based access control (RBAC) roles
- Azure active directory administrator roles

**Determine role-based access control roles**

Owner

Contributor

Reader

User Access Administrator

**Create Azure user and groups in Azure active directory**

**User accounts in Azure AD**

Administrator has highest level of access

User accounts are followed

Guest users have most restricted access

**Permissions and roles**

**Administrator roles**

Has access to create and delete user

Elevates access control on whos doing what

Cmdlet New-AzureADUser

CLI az ad user create

**Member user**

Not administrator or a guest user falls into this category

This user is a member of organization but do not have any access on creating or deleting users

**Guest user**

Has restricted user access

Can use their own school/social identities.

By default member users can give invites to guest users.

**Add user account**

CLI - az ad user create

Powershell - New-AzureADUser

**Delete user accounts**

Delete user accounts through azure portal, azure powershell or CLI

Remove-AzureADUser

CLI - az ad user delete

**Manage app and resource access by using Azure active directory groups**

**Access Management in Azure AD**

Azure AD roles

Role based access control(RBAC)

**Access rights through single user or group assignment**

Direct assignment

Group assignment

Rule based assignment

**Creating blob storage**

Container provides a group of a set of blobs

Powershell New-AzStorageContainer

**Create Blob access tiers**

Hot

Cool

Archive

**Add blob lifecycle management rules**

You can move the data to transfer based on the usage between hot cool and archive

**Configure VM availability**

**Implement autoscale**

VM can set to scale automatically increase or decrease

**Benefits**

Automatically adjust capacity

Scale out

Scale in

Schedule event

Less overhead

**Configure autoscale**

Enable autoscale

Define minimum, maximum and default number of VM instances

Minimum no of VM

Maximum no of VM

Scale out CPU threshold

No of VMs to increase by

Scale in CPU threshold

Number of VM to decrease by

**Configure VM Extensions**

**Implement VM Extensions**

Azure VM extensions are small application that provide post deployment configurations and automation tasks on Azure VM’s

Can be managed with CLI, Powershell and ARM templates and Azure portal

**Implement custom script extension**

**CSE** can be used to automatically launch and execute Virtual machine customization tasks post configuration.

**Powershell** Set-AzVMCustomScriptExtension

**Considerations**

Timeout

Dependencies

Failure Events

Sensitive Data

**Implement desired state configuration**

**Plan virtual machines**

Provisioning VM to Azure requires planning

Start with network

Name VM

Decide the location of the VM

Determine the size of the VM

Understanding the pricing model

Storage for the VM

Select an operating system

**Determine virtual machine sizing**

**General purpose**

Balanced CPU-to-memory ratio. Ideal for testing and development, small to medium databases and low to medium traffic web servers

**Compute optimized**

High CPU-to-memory ratio. Good for medium traffic web servers, network appliances, batch processes, and application servers.

**Memory optimized**

High memory to CPU ratio. Great for relational database servers, medium to large caches, and in-memory analytics.

**Storage optimized**

High disk throughput and IO ideal for Big Data, SQL, NoSQL databases, data warehousing, and large transactional databases.

**GPU**

Specialized virtual machines targeted for heavy graphic rendering and video editing, as well as model training and inferencing(ND) with deep learning. Available with single or multiple GPUs.

**High performance compute**

Our fastest and most powerful CPU virtual machines with optional high-throughput network interfaces (RDMA).

**Determine Virtual machine storage**

**Configure VM availability**

**Plan for maintenance and downtime**

Unplanned hw maintenance

Unexpected downtime and

Planned maintenance

**Setup availability sets**

Azure ensures that the VM’s you place within an availability sets run across multiple physical server, computer racks, storage units and network switches

- For redundancy, configure multiple virtual machines in an availability sets
- Configure each application tier into separate Availability sets
- Combine load balancer with availability sets
- Use managed disks with virtual machines

**Review and update fault domains**

Helps azure maintain high availability and fault tolerance when deploying and upgrading applications. Each VM in one availability set is placed in one update domain and one fault domain

**Azure fundamentals**

Azure is a cloud computing platform.

Hosting websites to running full virtual computers online to run custom software solutions.

Remote storage, database hosting and centralized account management.

AI and IoT too.

Azure fundamentals - series of six learning paths that familiarize you to services and features

Core compute, network, storage and database services, cloud security best practices, IoT and machine learning

Cloud concepts- 20-25%

Azure services - 15-20%

Core solutions and management tools on Azure - 10-15%

General security and network security features - 10-15%

Identity, governance, privacy, and compliance features - 20-25%

Azure cost management and Service level agreements - 10-15%

Compute

Networking

Storage

Mobile

Database

Web

Internet of Things

Big Data

AI

DevOps

**Compute Services**

Azure Virtual Machines - Windows or Linux vm hosted in Azure

Azure Virtual Machines Scale sets - Scaling for Windows or Linux VM hosted in Azure

Azure Kubernets Services - Cluster management for VMs that run containerized services

Azure service Fabric - Distributed systems platform that runs in Azure or on premisis

Azure Batch - managed services for paralles and high performance computing application

Azure container instances - Containerized apps run on Azure without provisioning servers or VM's

Azure Functions - An event driven, serverless compute services

**Networking**

Azure virtual network - connects vm to incoming virtual private network VPN connection

Azure load balancer - Balances inbound and outbound connections to applications or service endpoints

Azure Application Gateway - Optimizes app server farm delivery while increasing application security

Azure VPN Gateway - Access Azure Virtual Networks through high-performanace VPN gateways.

Azure DNS - Provides ultra-fast DNS responses and ultra-high domain availability

Azure content delivery network - Delivers high-bandwidth contednt to customers globally.

Azure DDoS protection - Protects Azure hosted application form distributed denial of service

Azure Traffic Manager - Distributes network traffic across Azure regions worldwide.

Azure ExpressRoute - Connects to Azure over high-bandwidth dedicated secure connections.

Azure Network Watcher - Monitors and diagnoses network issues by using scenario-based analysis

Azure Firewall - Implements high-security, high-availability firewall with unlimited scalability

Azure Virtual WAN - Creates a unified WAN that connects local and remote sites.

**Storage**

4 main types of storage

Azure Blob storage - Storage files for large files or bitmaps

Azure File storage - File shares can be accessed and managed like a file server.

Azure Queue storage - A data store for queuing and reliably delivering message bet application.

Azure Table storage - stores non-relational structured data (also known as structured No SQL data) in cloud, providing a key/attribute store with a schemaless design.

**Common characteristics**

Durable

Secure

Scalable

Managed

Accessiable

**Mobile**

Azure backend services can be created easily

Other features

Offline data sychronization

Connectivity on premisis data

Broadcasting push notifications

Autoscaling to match business needs

**Databases**

Azure provides multiple databases services

Azure Cosmos DB - Distributed DB that supports NOSQL

Azure SQL Database - Fully managed relational database with auto-scale, integral intelligence, and robust security

Azure database for PostgreSQL - Fully managed and scalable PostgreSQL relational databasw with high availability and security

SQL server on Azure Virtual Machines - Service that hosts enterprise SQL Server apps in the cloud

Azure synapse Analytics - Fully managed data warehouse with integreal security at every level of scale at no extra cost

Azure database Migration Services - Service that migrates databases to the cloud with no application code changes.

Azure Cache for Redis - Fully managed service chaches frequently used and statc data to reduce data and application latency/

Azure Database for MariaDB - Fully managed and scalable MariaDB relational database with high availability and security

**Web**

Azure app services - Quickly create powerful cloud web-based apps.

Azure Notification hubs - send push notifications to any platform from any back end.

Azure API management - Publish API's to developers, partners and employees securely at scale.

Azure Cognitive Search - Deploy this fully managed search as a service

Web apps fearure of azure app serveices - Create and deploy mission-critical web apps at scale.

Azure signalR services - Add real-time web functionalities easiley.

**IoT**

IoT central - Fully manager global IoT Software as a service (SaaS) solution that makes it easy to connect, monitor and manage IoT assests at a scale

Azure IoT Hub - Messaging hub provides secure communication bet monitoring millions of IoT devices.

IoT Edge - Fully managed service that allows data analysis models to be pushed directly onto IoT devices, that allows them to react quickly without needing to consult the Cloud AI models

**AI**

In context to cloud, AI is based around a broad services, the core of which is machine learning.

Machine learning is the data science technique that allows computers to use existing data to forecast future behaviours, outcomes, and trends.

Froecast or prediction from the machine learning can make the machines smarter

Azure machine learning services - Cloud-based environment you can use ot develop, train, test, deploy, manage, and track machine learning models. It can auto-generate a model and auto-tune it for you. it will ley you start training on your local machines, and then scale out to the cloud.

Azure ML studio - Collaborative visual workspace where you can build, test and dploy machine learning solution

Vision - Use image-processing alogrithms to smartly identify, caption, index, and moderate prictures and videos

Speech - Converts spoken audio into text, use voice for verification or add speaker recognition to your app

Knowledge mapping - Map complex information and data to solve tasks susch as intelligent recommendations and sematic search.

Bing Search - Add Bing search APIs to your apps and harness the ability ot comb billions of webpages, images, videos, and news with a single API call.

Natural Language processing - Allow your apps to process natual language with prebuilt scripts, evaluate sentiments, and learn how to recognize what users want.

**DevOps**

Azure DevOps - Use development collaboration tools such as high performance pipelines, free private GIT respositories, configurable kanban

Azure powershell

Recent version of powershell

Git hub to check them

Active Directory

Creating a new directory

Tenant a cloud group

**—--------------------------------------------**

**104**

**Manage Azure identities and governance (15 to 20% on exams)**

- Manage Azure Active Directory (Azure AD) Objects
- Manage Role-based Access Control (RBAC)
- Manage Subscription and Governance

**Azure Active Directory**

There is difference bet on premises and azure AD

Can set up sync between premises and Azure AD

Focused towards web apps and web used

On premises (Object and LDAP)

SAMAL OLAP????

Can create multiple AD Tenants

**Pricing**

Free account

Pay as you Go

**Managing multiple Azure Active Directory**

Account

Tenant

Subscriptions

Resource Group

**Account** - user/person/program

App - Managed identity

**Tenant** - Organization

Rep by public name

Will be assigned a domain name if not specified

A dedicated instance of Azure AD

Every Azure Account is a part of at least one tenant

**Subscriptions** - Pay as you go billing arrangement

All azure resource usage gets billed to the payment method of the subscription

- Free
- Pay as you Go
- Enterprise agreements

Not every **tenants** must have a **subscription**

One **tenant** can have **more than one subscriptions**

**More than one account** can be a **owner** in a tenant

Owner, Contributor, Reader or anything

**Create Az AD**

Creating a user will automatically create a tenant for you

You may not be owner of the tenant

When you create a new account you are a Global administrator automatically

You can create a NEW Az Active Directory by going into the menu(You can modify menu how it looks under settings)

Creating a new directory - Manage tenant - Create - Basic - Az active directory or B2B - Configuration - Org name, Initial domain name, Country.

**Azure AD Tenants**

Tenant ID is the unique ID you might need if you want to activate something particular

You can find it in Overview

AD is identity services used to manage user

Type is a member (Not external)

Profile shows the user details

Assigned roles (Global admin or user or other roles that are assigned to you)

You can also customize the role

Every tenant should have one Global administrator

**Switching between tenants**

Manage tenants - choose and click on switch

Profile on the top right corner

Switch directory  - All directory - Switch

**Add custom domains**

Customised domain name

Onmicrosoft.com

When you add a user to the domain - is the only domain with onmicrosoft.com

**Custom domain name** option

To prove that we own it

We need to add TXT or MX record

By adding those we can verify them to activate the custom domain

You can add user with custom domain after you get verified

**Azure AD Join**

Now its cloud first active or cloud only active directory

Can be primarily setup for a user

Can use remote server to use login to the on premises

**Administrative units**

Tens of thousands of users and dividing into units

**Manage users and Groups**

User, groups and devices can be managed

Creating a group

Group type, Group name and Description also membership type

On Active directory while you are creating a new user you can specify where the user belong to by adding it on

New user would require

- Name
- User name
- Groups
- Directory role
- Password field (Already assigned)
- Create user

Creating a new guest user (The one for the temporary user)

Under membership type

Assigned (Default)

Dynamic group (Creates automatically by creating the rules)

Dynamic device(Creates automatically by the type of the device they use)

**Self Service password reset**

Authentication methods

**Manage Azure AD devices**

We could configure what kind of a person has using their device

To configure

Windows - search connect to - Access work or school - Connect

Use your work email account and password to connect

**Bulk operation**

Create

Invite

Delete

Download

**RBAC**

**Role Based Access Control**

Authorization is the major task that is covered in RBAC

Access is provided to an individual depending on the role that they have

All the access is preconfigured based on the TITLE that an individual has

We can also configure what they can access using Custom RBAC

Highest level is the Global administrator (could be a owner)

There can be admin for different task as similar to a real life scenario

You could go into the description of a role to see what assignments has been assigned to a user/role

**Manage Subscriptions and Governance**

**Account, subscriptions and resource group**

Basic concept of Accounts and Subscriptions

- Account
- Tenant
- Subscription
- Resource Group

**Account**

User ID - person/program

Considered a bad programing practice when using a normal user id and password for an application

**Tenant**

Usually a tenant is associated with the organization

Represented by public domain

Will be assigned default onmicrosoft.com domain if not assigned one

A dedicated instance of Azure Active Directory

Every azure account is a part of at least one tenant

**Subscription**

Billing agreement with microsoft

- Pay as you go
- Free subscriptions
- Enterprise agreements

Not every tenant has subscription

No resources without subscriptions

So no billing

Tenants can have more than one subscription at a time

More than one account be a owner on a Tenant

Grant them roles

**Resource**

Resources are entities that are managed by azure

Such as VM, web app, storage account

Also we have sub resources such as public IP when VM is created

Network interface card and network security group

Accounts can be given read, update, owner rights to resources

**Resource group**

A way of organizing resources in a subscription

All resources must belong to only one resource group

Resource group can be deleted (Which deletes the resources inside)

A way of separating out projects, keeping unrelated things separate

**Assigning admin permissions**

When you add a new user

They are being assigned with regular contributor role

You could change the access and assign new permissions using the user’s access

**Cost centre and tagging**

Can be found under cost analysis

**Resource Groups and Resource Locks**

Managing and configuring resource locks

Organizational structure of a resource

Resource groups cannot be nested

Resources can be VM, storage account, SQL or web app etc..

Deleting a resource group will delete all the resource under the group

**Locks**

Slow down or prevent people to reduce create/delete or modify a resource

**Azure Policy**

Can update policy and governance make a admin stop from creating any resources

JSON notation - can use it to create a policy

Can custom design a policy

Security and billing restrictions

Built in policy

**Resource Group Policy**

Can be assigned to a particular resource group instead everything under a subscription

**Move resources**

Helps in moving resources to different resource group or a subscription

**Managing policy by powershell**

**Subscriptions and Governance**

Account

Tenant

Subscription

Resource group

**Account**

User ID

Person / program

Using a real person’s user ID and password for program

**Tenant**

Organization or the company

Usually represents the company domain

If you haven’t provided one it will assign with onmicrosoft.com domain

Every Tenant has a instance of Azure active directory

Every azure account is part of at least one tenant

**Subscription**

Billing agreement with microsoft

Free subscription

Pay as you go

Enterprise agreement

Not every tenant have subscription

Means that tenant cannot use any resources

Can have multiple subscription

Account can be a owner in a tenant

Possible to have more than one owner in a tenant

You can invite as many members in tenant and you can grant them roles

**Resources**

VM

Web app

Storage

**Sub resources**

Public IP

Virtual network

And others

**Resource group**

Organizing resources as collection under a group

Easy to grant permissions

Manage billing

Sandbox system

Can delete a group when a project is over

**Assign admin privileges**

Create a user

Name

Custom domain

Full name

Password auto generated

When you basically create a user he is going is to have access to nothing

Would be assigned a member usage

Go to subscription

Access control (IAM)

Click on the user

You can check on the role over there

Contributor can do things but cannot allow any access to other people

**Azure policy**

Granting permission to create any resource will take place in azure policy

Applies some sort of governance

No of built in policy

Also we can customize a policy

When a resource doesn’t meet the policy it might show up on the audit document

Tagging - can help to narrow down where the change occurred

Tagging can be helpful with metadata

How do we stop someone from creating a resource for higher cost

Search for Policy

Definitions

Predefined policy from Microsoft

We can enable by assigning them

Instance - Allowed VM size SKU

Defined on JSON format - would have if condition rules defined

If the VM SKU is not in allowed list - It would deny the function of creating one

Can create a policy that could also be assigned to an entire resource group

**Resource Group Policy**

Go into a resource group

Policy under the group

Select the policy that you want to assign

Compliance state - evaluating a compliance wouldn’t run on regular basis

Can make forcefully run it to make compliant

Cloud shell - Power shell - Start-AzPolicyComplianceScan -ResourceGroupName ‘Nameofthegroup’

**Moving a resource**

Maybe in future if you wanted to make your resource look organized or move it to different branch or add it under a new subscription you can do it by moving it

Select the resource

Select the move option on the top right corner

Click on it

Select the check mark on which resource to move and you could move it fine

Select the group where it needs to be moved

And check on it

**Managing policies by powershell**

Go in to the policy

Definition

Cloud shell

Powershell

Clear

>Get-AzPolicyDefinition | Where-Object {$_.Properties.DisplayName -eq “Audit missing tags on resources”} // Audit missing tags on resources - resource name or resource ID

>$definition = Get-AzPolicyDefinition | Where-Object {$_.Properties.DisplayName -eq “Audit missing tags on resources”}

Creating a new resource group

>New-AzResouceGroup -Name “phur” - Location “East US”

Assigning a new policy to a group

>New-AzPolicyAssignment -Name “CheckingRules” -DisplayName “Checking the rule” -Scope $rg.ResourceId - PolicyDefinition $definition

**Subscription and Management groups**

Creating an account you will have a tenant and you will have a default user as you

In order to create any resources you need a subscription

You can add more than one subscription

You can go to the subscription tab and click on the new button to create one

When creating a resource you can choose which subscription you want

Creating a new subscription for each client would be a very proactive way of understanding how much they would they get charged

**Management group**

Can contain other management group or subscription

You can select on the subscription group to be staying under a management group if you want to control it on a whole

**Storage account**

Storage account is basically to store things on the cloud

Services can be built on top of storage account

- Container called as blob
- File based like file explorer
- Managed storage account

How to create

Create a resource

Storage account and create from there

**Basic**

Select the subscription

Resource group where it belongs to

Storage account name

Region

Performance

Redundancy

- Locally redundant storage
- Geo redundant storage(copy of files in secondary region)
- Zone redundant storage(Separate data centre)
- Geo Zone redundant storage(secondary region and separate data centre on both the region)

**Advance**

Enable a secure transfer (Https)

Infrastructure encryption (double encrypted in the infrastructure)

Enable blob public access(to access over internet)

Storage key access(default way to access storage access)(Can disable in recent one and activate authentication through azure)

TLS version (encryption microsoft thingy)

Data lake storage gen2(to accelerate big data workloads)

Enable hierarchical name

**Blob Storage**

**Azure files**

**Tables and Queues**

Blob storage

NFS v3 - protocol for sharing and mounting files

Access tiers

Hot or cold

Hot - frequently accessed on day to day usage

Cold - infrequently used

Azure files

Enable large file share - 100Tb of files share

Table and queue

Key encryption

**Networking**

Publicly available endpoints(on all network)

Public endpoint on selected network

Private endpoint

**Network routing**

Microsoft network routing (Secure microsoft routing + charges)

Internet routing (Public internet routing)

***Data protection***

**Recovery**

Enable point in time restore for containers (choosing the previous point to restore)

Enable soft delete for blob(enabling recycle where we can enable restore is called soft delete)

Enable soft delete for containers

Enable soft delete for file shares

Enable point in time restore will force you to enable soft delete

Tracking - notification if any changes has occurred

***Review and create** to deploy the storage account*

**Access Keys**

2 access keys

As one in them is back up

Access keys are how you get into the storage account

**Shared access signature(SAS)**

Would give the user with certain features disabled

You could create a shared access keys by just enabling read access and disabling write and delete

**Storage explorer**

**Creating a container**

Data storage - containers - +container

Name - desired name

Public access level (determines how users can access and what kind of access level they might have)

You can upload by clicking no upload button

Files are being charged based of file size - gigs

Even if the file is less than a gig you would be charged for a gigabyte

You could click on file **generate SAS**

The file that is uploaded can be accessed using SAS

Storage explorer is a default look like windows where you can find categorized and organized form of files uploaded

**Log analytics**

Monitoring the storage

Performance and kind of files stored can be monitored

Overview can be checked for failure, authentication error and more

Storage account can store upto 5 Petabyte

Can create a rule where you can monitor if certain action or threshold is reached or broken

Can create diagnostics to monitor where you can take every action that has been taken place

**Redundant storage**

- *Locally redundant storage*
- *Geo-redundant storage*
- *Read-access Geo-Redundant storage*

Locally

2 additional copies are stored in local(One region) for a total of 3 times

Geo-redundant

Two region for a total of 6 copies (3 in each location)

Read access Geo-redundant

Read access geo redundant would give read access to the file on region 2 and 3.

*Geo Replication*

Another region

Prepare for failover

**Copy file with Az copy**

Command line tool

Allows you to move and copy files from your computer using command line

Dir az*.exe

Az copy

ZIP program

./azcopy copy ‘source SAS url’ ‘destination SAS url’

**Access tier**

**Hot** or **Tire**

Charges are based on the selection

Hot are charged more

Cools are basically half, but access costs are double.

Already existing containers can be changed tiers under properties

**Archive** tier is almost as deleting the file

Would take hours to retrieve when placed in there

There are ways to take the files within an hour but have to ask put in a request to retrieve it within an hour

**Premium** access tier

**Lifecycle management**

Storage account - blob storage - lifecycle management

**Access control for storage**

Can give permissions to resources using **ACCESS keys**

**Shared Access Signatures (SAS)**

**Access control (IAM)**

**Object replication**

Any new files added to storage container and copying to a different containers

***Importing and exporting data to Azure***

**Moving large file**

We could use Storage Explorer to upload and download files

Can use azcopy through command line to move, copy or download data

Having terabytes of data to move could be very tedious to use Storage Explorer or azcopy

Import/Export job services comes in handy to do such task

Data box - 8 TB SSD

Data Box - 100 TB BOX

**Blob Storage**

Similar to creating a Storage Explorer/Files and queues account

**CDN**

Content Delivery Network account

CDN is much more practical when it comes to files that might frequently be changed

Standard Microsoft - cheapest

Standard Akamai

Standard Verizon

Premium Verizon - Priciest

Premium Verizon account advantages

Dynamic site acceleration

Url customization

Mobile data delivery optimization

When you create a new CDN - You would have to purge a blob storage to connect to it

CDN works globally  and not particularly belongs to any resource group

***Configure Azure files***

**Create Azure file storage**

Blob doesn’t really have a strong file system

Default there is no file share

You would have to create a new one

Using a file share gives you access to connect to it like you do in a mapped drive

Can connect using powershell and command prompt

**Azure file sync**

Can sync files wherever you are

You download a file sync agent to do this

Deploy a sync storage - select the file share that you want to share

Azure file sync agent needs to be installed and configured

**Troubleshoot file sync**

If the sync is not happening or delayed - it would walk you through how to troubleshoot

***Implement Backup and Recovery***

**Azure backup**

Creating a backup services

Backup and site recovery (OMS) - Recovery Service vault

Backup can be stored in same location as the resource group

2 Services

Back up

Site recovery

**Site recovery**

Is something where entire server is going to replicate

When server goes down you restore this to a new region to make the server up and running

**Creating a backup**

Specify where the workload is running

Azure or On-Premises

What kind of backup can you do - For now you can back up

VM

File share

Sql server in a VM

Creating a backup policy

You would have to specify when you would need the backup to be running and how long to retain the backup once the services are deleted

Can also choose the time zone when the time is retained

**Backing up a virtual machine**

Operations - backup - recovery services

**Recovery**

File recovery services

Backing up

**On-Premises Backup**

Install Recovery services Agent to download all the backup on your physical machine where runs on your PC to save everything on your physical PC

Backing up everything “Bare Metal Recovery”

Your would have to have a different server (Intensive server)

Microsoft azure backup server(needs to be downloaded)

**Backup reports**

Recovery services vault

Diagnostics settings

You can create an diagnostics under a archive Storage account / stream to event hub / send to log analytics

Turning on diagnostics, we have number of ways to collect diagnostics

**Storage account**

**Stream to event hub**

**Send to log analytics**

Connecting to log analytics

Concept of backup reports where it is tied to PowerBi

To do that we would need a storage account - once that is stored PowerBi can take info from that file and generate report

**Soft delete**

Soft delete is a security feature

For instance if someone deleted the files by accident it wouldn’t delete immediately

It would take upto 14 days to delete completely if it is not restored within 14

**Site recovery / ASR - Site to site replication**

Some cases azure could fail

Provides high availability when you go through with site recovery

When site goes down, we would have a site replication ready to go increase availability

Would take less than half hour to bring it back on site

Takes a resources running on one region and replicates the resource on a different region

Consider VM running in West US

VM - Operations - Backup - Disaster recovery

Given a map to replicate to a different region

Can select on the options from drop down list on where you could connect and work on it

Advance settings - you could configure rest of the things there

Could find the recovery service running under - Site recovery vault

**ASR test failover**

Site recovery vault

Go to VM

Operation - disaster recovery

Recovery services vault

Failover and test failover

Failover- would recover when it main VM fails(Deletes the original VM and recovers with the substitute)

Test failover - is to test to see if all of the files are there on the second vm

Cleanup test failover - would clean test failover after checked

**Create a Virtual Machine**

Create a resource

Windows server/Ubuntu server

Select subscription

Resource group (can select existing or new VM)

Virtual machine name

Region

Availability option/zone (Optional)(Will look into it further in future)

Image(Can choose from catalog of VM that Microsoft has)

Azure spot instance(VM at lot cheaper but you can get affected anytime(for low price))

VM size (Change size to select your preferred one)

B2s (2 cpu / 4 GB ram / 4 GB storage)

Administrator account

Username and password

For linux (SSH private key)

Ports to open

RDP/Webservice/FTP

Disk type (Premium SSD or HDD)

Encryption type

Data disk (additional storage disk)

Creates a virtual network by default (but if you want one that you already have you can choose that)

Accelerate networking (High speed connection)

Load balancing (Will have to check what's that)

Azure security basic for free

Logging and monitoring like boot diagnostics

Auto shutdown (shutting down will cost less)

Backup

Can set up VM extensions to run scripts

If its Linux you can run Cloud init

Dedicated host (OWN server which is not shared)

Proximity placement group (Physically closer together/ away from each other)

VM generation

Gen 1 and Gen 2 (which is UEFI basically)

Tagging (to set up meta data to identify easily)

Review and create (Comes up with hourly rate for VM)

Download a ARM template to automate this entire process

**Connecting to VM**

Go to resource

Status - running

Public / private IP address

Running state and disk operations

RDP/SSH/Bastion

Can download a RDP file that directly connects to it

You would have to use the username and password to connect to it

**VM availability**

How to enable high availability

While creating a VM you can select what kind of availability do you want for this VM

Also you cannot change this setting after creating a VM

*Availability option*

SLA (Service Level Agreement)

Covered with SLA is only when you use Premium SSD

99.9% availability

If the availability is less than that there is a price refund available

Also considers the Zone where the VM is placed into

Availability sets (can deploy about 3 set of the VM)

**VM Monitoring**

Overview page has overview of graphs which shows the monitoring graphs

Monitoring - Diagnostics

Enable guest-level monitoring

Creates a Storage account

Every 60 sec it would pull up the performance of CPU, Disk, Memory and Network.

Performance counter - customize when do you want the logs and how often

IIS activity logs

Crash dumps

Sinks

Does using a storage account

Microsoft agent can be uninstalled and installed again if you ever feel like a the data is not being pulled enough

**VM custom script extension**

After deployment a script to run to install all the files and make it deployed

But when you compare it to bare bone VM you would be able to deploy the VM as useable

Like installing all necessary tools on the VM and such

Go to the resources - Setting - Extensions - new resources - custom script extension - Install extension

Operation - Run command - you could open a Power shell and run from outside the environment

**Azure Bastion Services**

Azure Bastion Services is like how you connect to a VM using RDP or SSH

Bastion Server

Operation - Bastion

Bastion server itself has to exist on its own subnet

Manage Subnet configurations

Extend the virtual network

Subnets

Bastion environment is more secure way to connect to you VM resource

**Virtual machine Scale set**

2 or more VM running behind load balancer

VM scale set is used to add VM when there is heavy load or utilization and reduce the VM when there is less of the usage there

Where there is a lot of demand/traffic that your server is being used and CPU utilization is more than 75% it would create a new VM to share the load and when the VM utilization of CPU less than 25% it would delete one of the VM

Create a new resource group

Virtual machine scale set name

Create a region

Image

Azure spot instance (Yes or No)

Size

Admin account username and the password

Choose disk

Choose Network

Scaling

Instance - Instance count

Minimum and maximum VM

Diagnostics logs

Management

Monitoring health of the VM

**Creating a VM using powershell**

To create a resource group

New-AzResourceGroup - name nameofresource -Location location

To create a VM

New-AzVM -ResourceGroupName “nameofresource” -Name “nameofVM” -Location “location” _VirtualNetworkName “networkname” -SubnetName “default” -SecurityGroupname “securitygroupname” -PublicIpAddressName “myipaddress” -openPorts 80,443,3389

It would come up asking for admin username and password and thats what we do use to RDP into the VM

**Start and stop the VM using powershell**

Stop-AzVM -ResourceGroupName “groupname” -Name “VMname”

Start-AzVM -ResourceGroupName “groupname” -Name “VMname”

**Automation of VM - ARM templates**

Automation of deployment of virtual machines

Morden way of using and deploying into azure resource

ARM template is of TEMPLATE + PARAMETERS file

**~~~~~**

Azure Resource Manager model

ASM model - Classic dont use it anymore

Resource group - VM

Template

Template + Parameter

How an ARM template is?

How it is organized and how to modify the arm template

$schema - deploymenttemplate.json

Content version “1.0.0.0”

Parameter’s file

Variable - computed fields (this is where the variables are constructed)

Resources section (All of the key resources are confined)

Outputs (Would be used to output to show to the person who is using it also would required some form of input from them like the admin username and password)

**Resources of ARM template (template.json)**

Resources section of the ARM template contains the .json version of all the values and resources that are implemented in creating the VM such as network interface, network security group, Virtual network, public IP addresses, and such.

**Minimum required change to use this ARM template**

Change the parameters on the parameter.json

VM will have new name

Public IP address required needs to be new

Network card needs to be new

When you deploy a same resource again - azure reviews and ensures no properties are changed and redeploys again

**Deploying the changed ARM Template**

Now you can modify the ARM Template within the Azure

**Deploying Linux using ARM Template**

RHEL RedHat 7.3 SKU

Simple as deploying a windows VM

Change some parameters on parameters.json

Publisher - RedHat

Offer - RHEL

SKU - 7.3

**ARM custom script Extensions**

ARM template to deploy a Windows or Linux server

Later if you want to configure and deploy after the VM is created to make the VM usable

Custom script extension

“Type”: “Microsoft.Compute/VirtualMachines/extensions”

Storage

Using a existing VHD

**Manage Azure VM**

**Add disks to VM**

Disks are present under menus setting- Disks

Operating disks and data disks

Create and attach a new disk

Number, disk name Premium SSD, Size of disk, Max IOPS, throughput, Encryption and catch are the values that need to be implemented.

Once clicked on Save its saved and attached

You can detach and use this disk to another VM

You also can go to Size and performance and change as required but before doing that you would have to detach the disk

**Adding NIC interface to VM**

Menu - Settings - Networking

If you would want a VM to have different subnet or more than one virtual network combination

Go to the Virtual network - Address space - you could add a new address space to make it work.

Under Virtual network subnet you could add the new address space you created

Go to the VM now stop the VM

Networking - create a network adapter

We would use the same Virtual network and you could have one more network adaptor and assign the new subnet IP

**Changing the size of VM**

Going into the VM - Settings- Size of VM could be possibly changed

**Redeploying a VM**

Can use move command to move it into a different resource group

If a VM is unresponsive or anything unusual

We could redeploy the VM using powershell command

Set -AzureRmVM -Redeploy -ResourceGroupName “az102rg” -Name “aznewvm002”

Set-AzureRmVM -Redeploy -ResourceGroupName “name of resource group” -Name “Name of VM”

**Azure disk encryption**

Encryption type is where you would encrypt the VM

This provides encryption for the OS and data disk within the Azure VM

With windows its bitlocker

With Azure its is DMbit

**Manage VM Backups**

Intro

VM - Azure recovery vault operations

Recovery services vault has to be on the same region as the original VM

Backup policy - Daily or Weekly and you can choose when the VM needs to be backed up

You can also choose how long to save the data backup

**Azure App services**

Web apps

Upload and configuration and azure will run it

App service plan is required to have azure app services to run

App service plan is where the resources are hosts web apps

Creating a app service plan

Cost is being occurred here

Running apps might have limitation on what kind of OS that you are running on

Also you would have choose what kind of plan that you can use for the app that you trying to deploy

You can go up to spec picker to choose what kind of hardware that you want your app services to run on

All the tiers had its own features

Such as configuring the SSL/Custom domains or scaling instances

**Web apps**

Create a resource - Web app - put it under same app plan resource group

Attaches to name.azurewebsite.net

Choose between code or Docker container

Select the stack - Program which you are going to run

OS will depend on the kind of the program that you choose to run

**Web app settings**

Once the web app is deployed the URL for the webapp at overview should be live

From the live web page you can navigate to the deployment center

Configuration - Application setting - connection setting

How integrated - Continuous integration

Every time a code is updated the integration happens

Can also do FTP deployment

VS has built in Azure deployment connection

If you are familiar with IIS of Windows you would be familiar with configuration and application setting and versioning of the software

Remote debugging can be done if you are using windows to run your web app

Networking tab - VNet Integration

**Scaling web apps**

Option to scaling

Scale up and scale out

Scale up - moving to upper plan

Scale out - manual scaling in basic plan - defines how much instances that you can work on it

Instances in this case would be replicating the same web app with same resources

Azure would put in a load balancer in front of the web apps that have been created with scaling

Under basic plan you can have 3 instances that you can scale out

But if you move from B plan to S plan - Standard plan you could have 10 instances

Also in s plan there would be auto scaling

Custom autoscaling

You would have to scaling rules

Such as if CPU percentage would be more than 75% for about 5min straight you could scale a unit also vice versa where if your web app CPU is less than 25% then the instances would be reducing

**Backing up web apps**

How to manually and automatically back up the web apps that are running

Setting - Backup configuration

Target container - Storage account needed

Have to create a new one inorder to backup web apps

Once everything is created you can just click on backup button to backup

Backup schedule

You would use this to schedule the backup on a regular basis

Restore button on Backup menu would help to restore the older backup that is already taken

**App Service Network**

Azure app service network is multi tenant network that you would use to connect to the web app

Network security and firewall are major requirement to keep and authorize who can access the web app

Networking tab under setting can be configured

Access restriction - By default your app would have public IP and public domain name

You could configure allow and deny rules using access restriction feature

Inbound and outbound rules can be configured as necessary

You can manager your own SSL account you would have to do an app assigned IP setting

You could also do a private access IP for web app as endpoint access

VNet integration on to web app

Allows private access over VNet access

**AKS (Azure Kubernetes Services**)

Containers

Container model for Kubernetes is having something created on a local environment and can directly uploaded into container to be used as same as you could use it local environment

Can create a webapp deploy into a service plan and push it in to a container

Container have scaling and auto scalings

Kubernetes is a cluster (formerly a google standard)

Cross platform way of deploying a code

**Kubernetes**

Industry standard to run a service

Enterprise grade services - Industrial strength

High availability with all of necessary tools

**Container instance** - fastest and simplest way

For demo and production

Can be used for bursting when you need to expand

**Service Fabric Cluster -** can be used for micro services

Can added server outside az and you can add to this container

**Creating an Azure Kubernetes Services**

Create a kubernetes cluster

Resource group

Region

Kubernetes version

Virtual machines

Nodes

Node size

Node count

Can go up to 100 nodes

Node pool

Can contain several container under a node pool and divide the resources

Virtual nodes

Authentication

Networking

DNS settings

Load balancer

Monitoring for cluster

3 node cluster

**Kubernetes cluster**

Kubectl get nodes

**Deploying a container to AKS**

**Scaling Kubernetes services**

**Installing Docker Hub**

If you want to use OS that is not of yours you dont need to install docker hub

Docs.docker.com

You could go in there and download docker and add your code as a packager and add it to a repository

Windows

**ACI Azure Container Instances**

**Manage Virtual Networking**

**Virtual Networks**

Virtual networks binds various resources together

Cannot have resources without VN without connecting

Resources - Virtual network

Creating a virtual network

Only 250 free virtual network resources that you can create under a region

Resource group name and  name of virtual network and region

Address space

Can create a range of IP address for your network

CIDR notation mask you can change not to interfere with your other Private IP for overlapping

Address space with CIDR

Subnets that you can create for that IP address that you created to further subdivide the network according to needs

**Security**

BastionHost

DDos protection standard

Firewall

Tagging - Review and create

**Public IP address**

Creating a public IP address

New - Public IP (Search) - Public IP address - Create - Name - SKU - IPv4 and IPv6 - IP address assignment (Static or Dynamic) - Idle time out (How long do you keep connection open) - DNS Name label (newpublic.centralus.cloudapp.azure.com) - IPv6 (If you want to enable) - Subscription - Resource Group - location

**Network Routing**

Create new resource - Route Table (List of IP address ranges and how to send traffic) - Name - Subscription - Resource group - Location - Create

No custom user defined route by default

Implement rule (If the access a particular IP they would have to reroute to get to a firewall and clear before reaching the destination)

Route name - Address prefix - Next hop type(Virtual appliance for firewall) - Next hop address (Firewall address)

Subnet - Associate - New net - Backend

**VPN and Express routes**

Helps to join outside network to an azure network

VPN - Private - end to end

Benefit - able to access system on a private IP address

Within az you get 3 option

Point to site VPN

Site to site VPN

Express route

Point to Site and Site to Site uses public network

P2S is simple. Just as configuring a software

S2S needs a physical hardware that you need gateway

Express route - do not travel over public network

You would have to talk to communication provider to make this happen

Safer and expensive

Premium Add-on

Can connect to VNet all over the world

Standard would help you get just 10 VNet links

Premium can span up a 100

**Express route Direct**

Can connect directly to microsoft without ISP

Adv - Even higher speeds

Regular express route - circuit

With express route - multiple circuits on one connection

Will help with Massive data ingestion of 100 Gbps

Must have internal network that supports those speeds (hardware that operates on those speeds)

**Create Azure Firewall**

Designed for website and webtraffic - defies no of hacking like cross site scripting attack of SQL injection attack

3rd party firewall also can be ordered and connected

But MS has its own

New - Firewall - create a firewall - resource group - name - region - availability zone - create a virtual network name - Address space - Subnet address space - Public IP address - force tunneling (can create a small subnet where all network can travel through forcing to go through firewall) - create

**Configure Azure Firewall**

On the Virtual network

Route table - create a new route table - resource group - location - Name

Subnet - associate - associate the firewall with a subnet

All traffic 0.0.0.0/0

Virtual appliance

IP address of firewall

Creating a rule

Add application rule collection

Name - Priority - Action

**Virtual WAN**

Create WAN - Resource group - Group location - name - Type

**Introduction to VNet Peering**

Communication between 2 different networks

Peering relationship would be able to give access to communicate within 2 networks

Add preering

**Configuring Global Peering**

If one network is placed in central US and other in Japan to make it connected we need to set up global peering

Forwarded traffic

Also traffic from 2 to 1 and 1 to 2

Virtual networking is free but peering is not free and would got much more where you would have to pay for inbound and outbound traffic too

**Azure Network to Network Gateway**

Second way to do a peering

Its using Gateway

Gateway subnet

Network gateway set up site to site VPN between 2 points

Can set up VPN physical network on the gateway

Virtual network gateway - Have to create one where your virtual network is

Gateway - connection - add - VNet to VNet

Name - ToJapan

**DNS within Azure**

Domain name system

Domain name turned to IP address which computer and services uses to communicate

IPv4 and IPv6

Sometimes cached on local computer to make it easy to communicate

You would have to Azure Private DNS to run own services

No config required

Can use hostname to connect to it

***Private DNS services*** - Own benefit

Can create own customer domain name - only valid on your network cannot be accessed with or over network - they are called as ***labels*** - inside a network only

Modify IP settings for modifying it

Can create 34 labels inside a network

**Creating a Private DNS Zones**

Public DNS zones

Private DNS Zones

Public DNS - available over the internet

Private DNS only within azure network

Creating a Private DNS Zone

Name - Label.lable (Example devserver.local)

**Secure access to virtual network**

Network security groups

Allows us to specify which type of traffic is allowed and denied

Can be attached to the subnet or a interface

**Load Balancer Concepts**

Takes traffic and distributes according to an algorithm

Option 1 - Scaling up - getting a big server

Option 2 - Scaling out - Load balancer is what we use here

When the VM is doubled - serving traffic the load balancer will distribute the traffic

**Setting up Load Balancer**

Create a resource - Load Balancer

Resource group - Name - Location

SKU - Basic - Standard

Type - Public and internal IP

Front end - Load balancer is the IP that the traffic is going to be sent

If it is a internal IP address then the traffic would go to the Public IP of resource and then from there Load balancer would distribute the traffic once it gets it

**Troubleshooting a load balancer**

**Create Application Gateway**

Load balancer understands IP address and Ports that are sent to it

It operates at layer 4 and hence it do not understand any URL

That is where application gateway comes in

A basic load balancer shouldn’t cost us

But with application gateway there is always cost associated

Application gateway comes at layer 7

Hence understand URL and more

Can Enable scaling of the gateway itself

Its a device that lives on the virtual network

So you would need to have a Virtual network defined

**Azure monitor for Networks**

Network performance monitor

Connection monitor and Azure Network Watcher

Azure monitor

Networks

Insights

Have to establish connection monitor

Create connection monitor

**Network Watcher**

Enables you to monitor and diagnose conditions at a network scenario level

You would need a VM to check how it works

Enable network watcher for a particular region

Can IP flow verify

**Hub and Spoke Network Design**

(Long video Skipped)

**Overview of Azure monitor**

Insights

Application - web apps are monitored in application insights

Azure monitors do not do anything unless we connect the resources into it.

**John Savile’s Azure**

Types of services

On Premises

Infrastructure as service

Platform as service

Software as service

**Identity**

- Identity Basics
- AD and Azure AD
- Conditional access and MFA
- PIM

**Identity**

Least possible privilege for anyone or any resource

Action as roles and assign the roles to identity

Security principles

Actor (Anyone or anything) could be identified what he is capable of

Central store

**Azure AD**

Identity provider for most of the actor

All the resources and application would come to identify who are what is given access to from Azure AD

Azure AD is not the same as Active Directory

Active Directory

Runs on premises

DNS services for location where it is

Federation is connection between Cloud and Premises

SKU’s of Azure AD

- Free
- Office 365
- Premium P1
- Premium P2

License on per user per month basis

Free SKU has 500000 object limits

Single Sign ON (For both AD and Azure AD)

Device registration

Azure AD connect - Takes objects from Premises to the cloud

Cloud user - Directly created on the Azure AD

Multi factor authentication

**Premium features**

MFA - Conditional access

Self service password reset

AD to Azure AD

Source of truth is AD, but on premium you could make changes on cloud and does the changes on the on premises

**P2 -**

Identity protection

Identity Governance

**How to get Azure AD?**

Managed through Azure or Office portal

Azure AD portal

Aad.portal.azure.com

Anyone can create additional Azure AD instances

But the resources have to be trusted to make it active, or you cannot create any resource by yourself unless you have necessary permissions

By default name.onmicrosoft.com

Can add custom domain through custom domain names - and add a custom domain

**Azure AD Objects**

Users - replicated from AD or cloud user

Groups (Assigned/Dynamic)

Enterprise Application / Azure Resources (Service principles)

Devices

Stuffs

User and groups often comes from AD

Best practice

**Authentication and Authorization**

Authentication - you are who you are

Authorization - What can be done/allowed to be done by you

Federated authentication

- Password Hash (Cloud)
- Pass-through authentication (Hybrid)
- Federation (Hybrid)

Authorization is against Azure AD

**Roles and Administrative units**

Built in roles related to Azure AD and Microsoft SaaS

Roles can be given to the user and special type of groups

Custom roles can be created if built in one do not meet requirement

Always think least privilege

Scope is actually global, but not when its defined within a administrative unit

**Privileged Identity management (PIM)**

Enables elevation of Azure AD (and ARM) roles when needed

Roles must be pre-assigned to be available for users

User then elevate on-demand or for a future time

Azure AD P2 feature!

Something like Teams Service Administrator

**Azure AD MFA (Multi Factor Authentication)**

Passwords on their own are not good

MFA blocks 99.9% of attacks

What is MFA

- Something we know (Pin/gesture)
- Something we are (biometric)
- Something we have (Phone, token, laptop)

Should be used sparingly or responding will become muscle memory

Part of Azure AD P1 or use security defaults (or be a Global Admin)

3rd party MFA - custom control to integrate into the azure

P1 feature - Conditional access

Domain - Password reset - Where you can set up the security questions

Conditional access - This is triggered for any authorization regardless of authentication method

Rich control on what they access on what role on what resource

**B2B and B2C**

**B2B**

This comes into place when you would have to add people that are not  from your organization

Either you can add them as guest or MSA/GMAIL/OTP (Also known as B2B Guest)

Authentication happens when he logins he would have OTP on his mailbox

MFA will happen at Authorization at the Azure AD - Not on their device

**B2C**

This is for the customer/Consumer

Application would use B2C tenant to authenticate a customer

There is identity provider using other third party authenticator like google and linked in

**Access reviews**

People change their role over time and do not lose old permissions that they have

Enables review on Group/app/role assignment

P2 feature

**AD in Azure**

Azure AD domain services

Azure AD joining for brand new Modern Management

When you created a Azure AD it would replicated a AD in a region

**Governance**

Importance of Guard Rails

Management group, Subscription and Resource Group

Policy, RBAC(Role Based Access Control) and Budgets

Standards and Architecture guidance

**Governance**

Governance in cloud is critical

Behavior is different in cloud compared to what we have in on premises

Admin imposes the rules

Admin is one who does provisioning

But on cloud user does provisioning themselves

But also the cloud has governance for Access, Budgets and Policy

Admin does all these governance put in place on cloud

Governance is all about enforcement of rules and ensuring proper functioning to standards

**Understanding the requirements**

What organization wants

Corporate standards

Regulatory compliance

Azure is a shared responsibility model for many aspect of compliance

Compliance manager can help track of different services on the cloud

All of these are all around mitigating risk

**Key Organizational Components**

**Management Group**

Putting this governance in place

Azure AD tenant

Having management group with subscription

Thought that tenant you trust various resources to run on it

As soon as you create a first management group, it would create a root management group

Point of this management group you could create a hierarchy of management group

You could have 6 level - multiple child but one parent

Arrange on based on

Business

Geography

Environment

Only a owner can move a group

**Subscriptions**

Subscription comes under management group

Can be under root management group or under one of the child of the management group

Anyone can create a subscription and link to your root management group

Can be created as much as possible

Recommended is to have a Production and development environment (To keep it to a minimum)

**Resource groups**

Created under a subscription

Resource group is created in a region and resources in that resource can be created in any region

Resources - VM, App services, storage services

Tags are attached to resources to make tracking easier

**Role Based Access Control**

You can implement at any management group

Assigns a basic role to a user on what they can do

Can be inherited from parent group

Can be implemented on a subscription level or a management group level

**Policy**

Similar to the policy - defines how and who can do what?

**Budget**

Can be implemented on different management level, subscription and resource groups

**Locking**

- Delete
- Read-only

**ARM (Azure Resource Manager)**

Understanding the structure of the resource helps with the policy

Everything in azure is made of resource that are defined in resource providers

Each resource has properties and actions

**Role Based Access Controls**

Some resources also can support RBAC on data plane

Inherited

Roles consists of action that are assigned to security principle at a scope

Access control - Role assignment

Inherited from the management group as well

PIM (Privileged Identity Management) roles - Azure resources

**Azure Policy**

Sits on the top of the Azure Resource Manager

Start with audit - when you deploy a azure policy

Azure security center is all about how you audit

Policy is a set of conditions built around the attributes and an effect

Policies can be grouped into initiatives for assignment and compliance

**Cost Management and Budgets**

Insights on what resources that we are spending

- Cost analysis
- Cost alerts
- Budgets - Alerts and action group

Cost allocation with EA or Customer Agreement

Estimate cost with Pricing Calculator to optimize azure costs

**Naming standards**

Having a standard is important

Azure has some great recommendations

Naming convention applies to all the sources and budgets

Have consistent for cloud and on premises

**Tagging**

Name value Pair

Identify attribute / Metadata

Standard for tags used and values

Can enforce use through policy

Helps with billings

Can be used for search and filter during billing

Can be a document if required

Can store a JSON on to a tag

**Blueprints**

Brings together different types of artifacts to stamp a configuration

- Resource group
- RBAC
- ARM JSON
- Policy
- Custom scripts

Different deploy modes

**Azure resource graph**

Provides way to query ARM very efficiently and across subscriptions using KQL

Can use portal, powershell or CLI

**Resilience**

Against HW failure

Software failure

Corruption